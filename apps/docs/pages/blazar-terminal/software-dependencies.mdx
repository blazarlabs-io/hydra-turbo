# Software Dependencies

The Blazar Terminal requires specific software components to function properly. This guide covers all necessary dependencies and their installation requirements.

## Operating System

### Raspberry Pi OS Lite (64-bit recommended)

**Requirements**:
- **Version**: Raspberry Pi OS Lite (64-bit)
- **Architecture**: ARM64
- **Kernel**: Linux 5.15+ (Bullseye) or newer
- **Base System**: Minimal installation without desktop environment

**Installation**:
```bash
# Download from official Raspberry Pi website
# Flash using Raspberry Pi Imager
# Enable SSH and Wi-Fi during initial setup
```

## Runtime Environment

### Node.js

**Version Requirements**:
- **Minimum**: Node.js 16.x
- **Recommended**: Node.js 18.x LTS
- **Architecture**: ARM64 compatible

**Installation**:
```bash
# Install Node.js 18.x via NodeSource repository
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# Verify installation
node --version
npm --version
```

### npm Package Manager

**Version Requirements**:
- **Minimum**: npm 8.x
- **Recommended**: npm 9.x or newer

**Update npm**:
```bash
sudo npm install -g npm@latest
```

## Bluetooth Dependencies

### BlueZ Bluetooth Stack

**Version Requirements**:
- **Minimum**: BlueZ 5.50
- **Recommended**: BlueZ 5.60 or newer

**Installation**:
```bash
sudo apt update
sudo apt install -y bluetooth bluez libbluetooth-dev

# Verify installation
bluetoothctl --version
hciconfig --version
```

### Development Libraries

**Required Libraries**:
```bash
sudo apt install -y build-essential libbluetooth-dev
```

## Core Node.js Packages

The Blazar Terminal application requires the following core dependencies:

### package.json

```json
{
  "name": "blazar-terminal",
  "version": "1.0.0",
  "description": "Blazar Terminal BLE Payment Service",
  "main": "src/index.js",
  "scripts": {
    "dev": "nodemon src/index.js",
    "start": "node src/index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "dependencies": {
    "bleno": "npm:@abandonware/bleno@^0.6.2",
    "express": "^5.1.0",
    "socket.io": "^4.8.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.0"
  }
}
```

### Package Descriptions

#### bleno (@abandonware/bleno@^0.6.2)
- **Purpose**: BLE peripheral library for Node.js
- **Fork**: Maintained fork of the original bleno library
- **Features**: 
  - BLE advertising
  - Service and characteristic management
  - Cross-platform compatibility
- **Usage**: Creates BLE peripherals and manages GATT services

#### express (^5.1.0)
- **Purpose**: Web application framework
- **Usage**: HTTP server for WebSocket server setup
- **Features**:
  - Minimal HTTP server
  - Middleware support
  - Request/response handling

#### socket.io (^4.8.1)
- **Purpose**: Real-time bidirectional event-based communication
- **Usage**: WebSocket server for merchant application communication
- **Features**:
  - WebSocket fallback
  - Room management
  - Event-based communication
  - CORS support

## System Dependencies

### Build Tools

**Essential Build Tools**:
```bash
sudo apt install -y build-essential python3 make g++
```

**Python Development Headers** (for native modules):
```bash
sudo apt install -y python3-dev
```

### Network Tools

**Network Utilities**:
```bash
sudo apt install -y net-tools curl wget
```

**Firewall Configuration** (optional):
```bash
sudo apt install -y ufw
```

## Installation Verification

### System Check

```bash
# Check Node.js installation
node --version
npm --version

# Check Bluetooth stack
bluetoothctl --version
hciconfig --version

# Check system resources
free -h
df -h
```

### Bluetooth Test

```bash
# Test Bluetooth functionality
sudo hciconfig hci0 up
sudo hciconfig hci0 piscan
sudo hcitool lescan
```

### Network Test

```bash
# Test network connectivity
ping -c 4 8.8.8.8
curl -I https://www.google.com
```

## Development Dependencies

### Development Tools

**Code Editor** (optional):
```bash
# Install VS Code Server (optional)
curl -fsSL https://code-server.dev/install.sh | sh
```

**Git**:
```bash
sudo apt install -y git
```

**Process Manager** (optional):
```bash
# Install PM2 for process management
sudo npm install -g pm2
```

### Debugging Tools

**System Monitoring**:
```bash
sudo apt install -y htop iotop nethogs
```

**Log Management**:
```bash
sudo apt install -y logrotate
```

## Security Dependencies

### SSL/TLS Support

**OpenSSL**:
```bash
sudo apt install -y openssl ca-certificates
```

**Certificate Management**:
```bash
sudo apt install -y certbot
```

### Firewall (Optional)

**UFW Firewall**:
```bash
sudo apt install -y ufw
sudo ufw enable
sudo ufw allow 22    # SSH
sudo ufw allow 3000  # WebSocket
```

## Performance Optimization

### System Tuning

**Memory Optimization**:
```bash
# Increase swap if needed
sudo dphys-swapfile swapoff
sudo nano /etc/dphys-swapfile
# Set CONF_SWAPSIZE=1024
sudo dphys-swapfile setup
sudo dphys-swapfile swapon
```

**CPU Governor**:
```bash
# Set performance governor
echo performance | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
```

### Bluetooth Optimization

**Bluetooth Power Management**:
```bash
# Disable Bluetooth power saving
echo 'SUBSYSTEM=="rfkill", ATTR{type}=="bluetooth", ATTR{state}=="0", ATTR{soft}=="0"' | sudo tee /etc/udev/rules.d/50-bluetooth.rules
```

## Troubleshooting Dependencies

### Common Issues

**Node.js Installation Problems**:
```bash
# Clean npm cache
npm cache clean --force

# Remove and reinstall Node.js
sudo apt remove nodejs npm
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs
```

**Bluetooth Permission Issues**:
```bash
# Add user to bluetooth group
sudo usermod -a -G bluetooth $USER

# Set capabilities for Node.js
sudo setcap cap_net_raw+eip $(which node)
```

**Build Tool Issues**:
```bash
# Install missing build tools
sudo apt update
sudo apt install -y build-essential python3-dev
```

### Dependency Verification

**Check All Dependencies**:
```bash
#!/bin/bash
echo "Checking Blazar Terminal dependencies..."

# Check Node.js
if command -v node &> /dev/null; then
    echo "✓ Node.js: $(node --version)"
else
    echo "✗ Node.js: Not installed"
fi

# Check npm
if command -v npm &> /dev/null; then
    echo "✓ npm: $(npm --version)"
else
    echo "✗ npm: Not installed"
fi

# Check Bluetooth
if command -v bluetoothctl &> /dev/null; then
    echo "✓ Bluetooth: $(bluetoothctl --version)"
else
    echo "✗ Bluetooth: Not installed"
fi

# Check system resources
echo "✓ Memory: $(free -h | grep Mem | awk '{print $3 "/" $2}')"
echo "✓ Storage: $(df -h / | tail -1 | awk '{print $4 " available"}')"
```

## Next Steps

- **[Installation & Setup](/blazar-terminal/installation-setup)** - Complete installation instructions
- **[BLE Protocol](/blazar-terminal/ble-protocol)** - BLE communication protocol
- **[API Integration](/blazar-terminal/api-integration)** - Backend API integration
- **[Payment Flow](/blazar-terminal/payment-flow)** - Payment processing flow
